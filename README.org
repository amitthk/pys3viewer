* pys3viewer

This project is a module for analyzing files from s3 bucket. 


** Structure

Directories:

| \docs          | contains documentation generated via sphinx         |
| \tests         | contains tests                                      |
| \venv          | virtual environment                                 |
| \pys3viewer\*  | The actual module for analyzing s3 data             |
| \pys3viewercli | Command line tool to run the module                 |
| \pys3viewerapi | flask rest api for the module                 |
| \pys3viewerui  | Angular4 frontend for pys3viewer                    |
| \jenkins       | helper groovy wrappers for jenkins pipeline as code |
| \ansible       | Ansible playbooks for continuous delivery           |

Files:
| Makefile    | Make commands                 |
| Jenkinsfile | Continuous delivery pipelines |


** Tools used

| Click     | Command line parser             |
| Sphinx    | Documentation                   |
| Flask     | Flask and flask_restful for api |
| Angular 4 | Front End                       |
| Boto3     | For interfacing with AWS        |
| Pylint    | Linting and code quality        |
| Pytest    | Testing                         |


In Consideration:

| s3stat              | Amazon log file analyzer                              |
| goaccess            | real time viewing of server logs in different formats |
| aws cognito         | Authentication against external identity providers    |
| aws emr/hadoop      | Map reduce to speed up indexing                       |
| mrjob               | to interface with elastic map reduce                  |

** Running from source

*** Running backend API (flask) on virtualenv

Install python3.6.4

#+BEGIN_SRC 
sudo yum install gcc openssl-devel bzip2-devel
cd /usr/src
sudo wget https://www.python.org/ftp/python/3.6.4/Python-3.6.4.tgz
sudo tar xzf Python-3.6.4.tgz
cd Python-3.6.4
sudo ./configure --enable-optimizations
sudo make altinstall
sudo rm /usr/src/Python-3.6.4.tgz
#+END_SRC

Install virtualenv

#+BEGIN_SRC
cd /usr/src/
sudo wget https://pypi.python.org/packages/d4/0c/9840c08189e030873387a73b90ada981885010dd9aea134d6de30cd24cb8/virtualenv-15.1.0.tar.gz#md5=44e19f4134906fe2d75124427dc9b716
sudo /usr/local/bin/pip3.6 install virtualenv-15.1.0.tar.gz 
#+END_SRC

Clone and run the API from source

#+BEGIN_SRC 

mkdir -p /tmp/pys3viewer
cd /tmp/pys3viewer
git clone https://github.com/amitthk/pys3viewer.git ./
cd /tmp/pys3viewer/
sudo /usr/local/bin/python3.6 setup.py install
/usr/local/bin/python3.6 -m virtualenv pys3venv -p /usr/local/bin/python3.6
source pys3venv/bin/activate
pip install -r requirements.txt
python -m pys3viewerapi.main
#+END_SRC

*** Running frontend

#+BEGIN_SRC 
cd pys3viewerui
npm install
npm run ng serve -- --environment=local
#+END_SRC

*** Running commandline interface

Use the above virtualenv and run following:

#+BEGIN_SRC 
python -m pys3viewercli.main
#+END_SRC
